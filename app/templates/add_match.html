<!DOCTYPE html>
<html>
<head>
    <title>Add Match</title>
    <script>
        function updateWinnerOptions() {
            const player1Select = document.getElementById('player1_name');
            const player2Select = document.getElementById('player2_name');
            const winnerSelect = document.getElementById('winner_name');
            const finishTypeSelect = document.getElementById('finish_type');

            winnerSelect.innerHTML = ''; // Clear existing options

            const defaultOption = document.createElement('option');
            defaultOption.value = '';
            defaultOption.text = 'Select Winner';
            winnerSelect.appendChild(defaultOption);

            if (finishTypeSelect.value !== 'Draw') {
                if (player1Select.value) {
                    const option1 = document.createElement('option');
                    option1.value = player1Select.value;
                    option1.text = player1Select.value;
                    winnerSelect.appendChild(option1);
                }
                if (player2Select.value) {
                    const option2 = document.createElement('option');
                    option2.value = player2Select.value;
                    option2.text = player2Select.value;
                    winnerSelect.appendChild(option2);
                }
            } else {
                const drawOption = document.createElement('option');
                drawOption.value = 'Draw';
                drawOption.text = 'Draw';
                winnerSelect.appendChild(drawOption);
            }

            if (finishTypeSelect.value === 'Draw') {
                winnerSelect.disabled = true;
            } else {
                winnerSelect.disabled = false;
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
          const player1Select = document.getElementById('player1_name');
          const player2Select = document.getElementById('player2_name');
          const finishTypeSelect = document.getElementById('finish_type');

          player1Select.addEventListener('change', updateWinnerOptions);
          player2Select.addEventListener('change', updateWinnerOptions);
          finishTypeSelect.addEventListener('change', updateWinnerOptions);

          updateWinnerOptions();
        });
    </script>
</head>
<body>
    <h1>Add Match</h1>
    <form method="POST">
        <label for="player1_name">Player 1:</label><br>
        <select id="player1_name" name="player1_name" required>
            <option value="">Select Player 1</option>
            {% for player in players %}
            <option value="{{ player.player_name }}">{{ player.player_name }}</option>
            {% endfor %}
        </select><br><br>

        <label for="player2_name">Player 2:</label><br>
        <select id="player2_name" name="player2_name" required>
            <option value="">Select Player 2</option>
            {% for player in players %}
            <option value="{{ player.player_name }}">{{ player.player_name }}</option>
            {% endfor %}
        </select><br><br>

        <label for="player1_combination_name">Player 1 Combination:</label><br>
        <select id="player1_combination_name" name="player1_combination_name" required>
            {% for combination in combinations %}
            <option value="{{ combination.combination_name }}">{{ combination.combination_name }}</option>
            {% endfor %}
        </select><br><br>

        <label for="player2_combination_name">Player 2 Combination:</label><br>
        <select id="player2_combination_name" name="player2_combination_name" required>
            {% for combination in combinations %}
            <option value="{{ combination.combination_name }}">{{ combination.combination_name }}</option>
            {% endfor %}
        </select><br><br>

        <label for="player1_launcher_name">Player 1 Launcher:</label><br>
        <select id="player1_launcher_name" name="player1_launcher_name" required>
            {% for launcher in launchers %}
            <option value="{{ launcher.launcher_name }}">{{ launcher.launcher_name }}</option>
            {% endfor %}
        </select><br><br>

        <label for="player2_launcher_name">Player 2 Launcher:</label><br>
        <select id="player2_launcher_name" name="player2_launcher_name" required>
            {% for launcher in launchers %}
            <option value="{{ launcher.launcher_name }}">{{ launcher.launcher_name }}</option>
            {% endfor %}
        </select><br><br>

        <label for="winner_name">Winner:</label><br>
        <select id="winner_name" name="winner_name" required>
            <option value="">Select Winner</option>
        </select><br><br>

        <label for="finish_type">Finish Type:</label><br>
        <select id="finish_type" name="finish_type" required onchange="updateWinnerOptions()">
            <option value="Survivor">Survivor</option>
            <option value="KO">KO</option>
            <option value="Burst">Burst</option>
            <option value="Extreme">Extreme</option>
            <option value="Draw">Draw</option>
        </select><br><br>

        <label for="tournament_id">Tournament (Optional):</label><br>
        <select id="tournament_id" name="tournament_id">
            <option value="">Select a Tournament</option>
            {% for tournament in tournaments %}
                <option value="{{ tournament.tournament_id }}">{{ tournament.tournament_name }}</option>
            {% endfor %}
        </select><br><br>

        <input type="submit" value="Submit">
    </form>
</body>
</html>